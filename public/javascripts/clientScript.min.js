/*! prime_solo_project 2015-11-01 */
var app=angular.module("beerBoardApp",["ngRoute","ngMaterial","ngMessages","xeditable","ngAnimate"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"/home",controllerAs:"home",controller:"HomeController"}).when("/about",{templateUrl:"/about"}).when("/credits",{templateUrl:"/credits"}).when("/admin",{templateUrl:"/admin",controller:"AdminController"}).when("/register",{templateUrl:"/register",controller:"RegisterController"}),b.html5Mode(!0)}]),app.controller("MainController",["$scope","$http",function(a,b){var c=this;c.loginOrOut=!1,c.logout=function(){c.loginOrOut=!1,b.get("/users/logout")},c.login=function(){var a=c.username,d=c.password;b.post("/login",{username:a,password:d}).then(function(a){a.data.success?c.loginOrOut=!0:alert("Username or password incorrect")})};var d;this.openMenu=function(a,b){d=b,a(b)}}]),app.controller("RegisterController",["$scope",function(a){var b=this;this.successMessage=function(){b.username&&b.password?alert("You have successfully registered, now please login!"):alert("Please fill out the required fields!")}}]),app.controller("HomeController",["$scope","$http",function(a,b,c){var d=this;d.showContent=!1,d.barLocation,d.bar,d.newRating=0,d.beerList=[],b.get("/users/names").then(function(a){d.choices=[];for(var b=0;b<a.data.length;b++)d.choices.push(a.data[b].barName)}),d.findBar=function(){var a=d.searchedBar;b.get("/users/search/"+a).then(function(a){d.bar=a.data,d.bar.street&&d.bar.city&&d.bar.state&&d.bar.zipcode?d.barLocation=d.bar.street+" "+d.bar.city+", "+d.bar.state+" "+d.bar.zipcode:d.barLocation="",d.beerList=a.data.beerList.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0})}),d.showContent=!0},d.newSearch=function(){d.showContent=!1,d.searchedBar=""},d.submitRating=function(a,c){var e=d.newRating[c];if(void 0==e)return e;var f={rating:e,beerName:a};b.put("/users/rate/"+d.bar._id,f).then(function(a){d.findBar()}),d.enlarge[c]=!1,d.newRating[c]=0}}]),app.controller("AdminController",["$scope","$http","$timeout",function(a,b,c){function d(){var a={beerList:e.beerList};b.put("/users/addBeer/"+e.bar._id,a)}var e=this;e.updateInfo=!1,e.customShow=!1,e.addCustom=!1,e.beerName,e.beerChoice=[],e.beerList=[],e.barName,e.bar,b.get("/users").then(function(a){e.bar=a.data,e.beerList=a.data.beerList,e.barName=a.data.barName.toUpperCase()}),e.getBeer=function(){var a=e.addBeer;e.addCustom=!0,b.get("/beer/search/"+a).then(function(a){if(e.beerChoice=[],a.data.length<6)for(var b=0;b<a.data.length;b++)e.beerChoice.push(a.data[b]);else for(var b=0;6>b;b++)e.beerChoice.push(a.data[b]);e.addBeer=""})},e.addNewBeer=function(a){e.beerChoice=[],e.addCustom=!1;var b={brewery:a.breweries[0].name.toUpperCase(),name:a.name.toUpperCase(),ibu:a.ibu,abv:a.abv,description:a.description,image:void 0,style:a.style.shortName,srm:void 0,availability:void 0,rating:0,ratingTotal:0,numOfRatings:0};"undefined"!=typeof a.srm&&(b.srm=a.srm.id),"undefined"!=typeof a.available&&(b.availability=a.available.name),"undefined"!=typeof a.labels&&(b.image=a.labels.large),e.beerList.push(b),d()},e.revealCustom=function(){e.customShow=!0},e.customCancel=function(){e.customShow=!1,e.beerChoice=[]},e.submitCustomBeer=function(){e.customShow=!1,e.addCustom=!1;var a={brewery:e.cusBrewery.toUpperCase(),name:e.cusName.toUpperCase(),ibu:e.cusIbu,abv:e.cusAbv,description:e.cusDesc,image:e.cusImg,style:e.cusStyle,srm:e.cusSrm,availability:e.cusAvail,rating:0,ratingTotal:0,numOfRatings:0};e.beerList.push(a),e.beerChoice=[],d()},e.deleteBeer=function(a){e.beerList.splice(a,1),d()},e.submitUserChanges=function(){e.updateInfo=!1,b.put("/users/update/"+e.bar._id,e.bar).then(function(a){e.successShow=!0,c(function(){c(function(){e.successShow=!1},3e3)},2e3)})},e.deleteUser=function(){confirm("Are you sure you want to delete your account?")&&b["delete"]("/users/delete/"+e.bar._id).then(function(a){a&&alert("Your account has been deleted")})},e.showTooltip=!1,a.$watch(function(a){a&&a.length&&(e.showTooltip=!0)})}]);